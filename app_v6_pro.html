<!doctype html><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><title>Revopt — Choice Configurator (v6 PRO)</title><style>body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial,sans-serif;background:#0B1020;color:#E6E9F5}.wrap{max-width:1100px;margin:auto;padding:16px}.card{background:#12162A;border:1px solid #242947;border-radius:14px;padding:14px;margin:10px 0}table{width:100%;border-collapse:collapse}th,td{border-bottom:1px solid #1E2450;padding:8px;font-size:14px;text-align:left}select,button{background:#0E1530;border:1px solid #273057;border-radius:10px;color:#E6E9F5;padding:8px 10px}button.primary{background:#4F46E5;border:none;font-weight:700;color:#0B1020}.kpi{display:inline-block;margin-right:12px;background:#0E1530;border:1px solid #1E2450;border-radius:12px;padding:8px 10px}</style><div class=wrap><h1>Revopt — Choice Configurator</h1><div class=card><small>VSP Choice Master v6 embedded • Fields: Category, Enhancement, Code, Notes, Copay, VSP, Chargeback</small></div><div class=card><label>Track <select id=track><option>SV</option><option>Progressive</option><option>Occupational</option></select></label> <label>Sun <select id=sun><option>Clear</option><option>Photochromic</option><option>Polarized</option><option>Tint</option></select></label> <label>Oversize <select id=over><option>None</option><option>80% of U&C</option></select></label> <label>Rimless <select id=rim><option>None</option><option>Drill</option><option>Groove</option></select></label> <button class=primary id=build>Build tiers</button> <button id=csv>Download CSV</button></div><div class=card id=tiers style='display:none'><div id=kpis></div><table><thead><tr><th>Tier</th><th>Items</th><th style=text-align:right>Copay</th><th style=text-align:right>VSP</th><th style=text-align:right>Chargeback</th><th style=text-align:right>Revenue</th></tr></thead><tbody id=tierbody></tbody></table></div><div class=card><details open><summary>Master rows (v6)</summary><table><thead><tr><th>Category</th><th>Enhancement</th><th>Code</th><th>Notes</th><th style=text-align:right>Copay</th><th style=text-align:right>VSP</th><th style=text-align:right>Chargeback</th></tr></thead><tbody id=master></tbody></table></details></div></div><script>const MASTER=[{"Category": "Material", "Enhancement": "Aspheric Plastic 1.50", "Notes": "nan", "Copay": 31.0, "VSP": 0.0, "Chargeback": 10.0, "Code": "AA"}, {"Category": "Material", "Enhancement": "Aspheric Plastic 1.50", "Notes": "nan", "Copay": 35.0, "VSP": 0.0, "Chargeback": 14.0, "Code": "AA"}, {"Category": "Material", "Enhancement": "High-index Plastic 1.53\u20131.60/Trivex", "Notes": "nan", "Copay": 56.0, "VSP": 0.0, "Chargeback": 29.0, "Code": "AB"}, {"Category": "Material", "Enhancement": "High-index Plastic 1.53\u20131.60/Trivex", "Notes": "nan", "Copay": 60.0, "VSP": 0.0, "Chargeback": 33.0, "Code": "AB"}, {"Category": "Material", "Enhancement": "High-index Plastic 1.66/1.67", "Notes": "nan", "Copay": 83.0, "VSP": 0.0, "Chargeback": 48.0, "Code": "AH"}, {"Category": "Material", "Enhancement": "High-index Plastic 1.66/1.67", "Notes": "nan", "Copay": 98.0, "VSP": 0.0, "Chargeback": 58.0, "Code": "AH"}, {"Category": "Material", "Enhancement": "High-index Plastic 1.70 and Above", "Notes": "nan", "Copay": 111.0, "VSP": 0.0, "Chargeback": 68.0, "Code": "AJ"}, {"Category": "Material", "Enhancement": "High-index Plastic 1.70 and Above", "Notes": "nan", "Copay": 118.0, "VSP": 0.0, "Chargeback": 78.0, "Code": "AJ"}, {"Category": "Material", "Enhancement": "Polycarbonate", "Notes": "Note: No Service Fee for covered polycarbonate for children/handicapped/Federal Plan.", "Copay": 35.0, "VSP": 0.0, "Chargeback": 14.0, "Code": "AD"}, {"Category": "Material", "Enhancement": "Polycarbonate", "Notes": "Note: No Service Fee for covered polycarbonate for children/handicapped/Federal Plan.", "Copay": 35.0, "VSP": 0.0, "Chargeback": 14.0, "Code": "AD"}, {"Category": "Material", "Enhancement": "High-index Glass 1.60\u20131.80 (Clear)", "Notes": "nan", "Copay": 60.0, "VSP": 0.0, "Chargeback": 35.0, "Code": "AF"}, {"Category": "Material", "Enhancement": "High-index Glass 1.60\u20131.80 (Clear)", "Notes": "nan", "Copay": 138.0, "VSP": 0.0, "Chargeback": 85.0, "Code": "AF"}, {"Category": "Material", "Enhancement": "Digital Aspheric Lenses \u2013 Plastic", "Notes": "nan", "Copay": 45.0, "VSP": 0.0, "Chargeback": 24.0, "Code": "BA"}, {"Category": "Material", "Enhancement": "Digital Aspheric Lenses \u2013 Plastic", "Notes": "nan", "Copay": 55.0, "VSP": 0.0, "Chargeback": 34.0, "Code": "BA"}, {"Category": "Material", "Enhancement": "Digital Aspheric \u2013 High-index Plastic 1.53\u20131.60/Trivex", "Notes": "Copay = 45+28 (SV) / 55+28 (MF)", "Copay": 73.0, "VSP": 0.0, "Chargeback": 16.0, "Code": "BA+BB"}, {"Category": "Material", "Enhancement": "Digital Aspheric \u2013 High-index Plastic 1.53\u20131.60/Trivex", "Notes": "Copay = 45+28 (SV) / 55+28 (MF)", "Copay": 83.0, "VSP": 0.0, "Chargeback": 16.0, "Code": "BA+BB"}, {"Category": "Material", "Enhancement": "Digital Aspheric \u2013 High-index Plastic 1.66/1.67", "Notes": "Copay = 45+58 (SV) / 55+68 (MF)", "Copay": 103.0, "VSP": 0.0, "Chargeback": 37.0, "Code": "BA+BH"}, {"Category": "Material", "Enhancement": "Digital Aspheric \u2013 High-index Plastic 1.66/1.67", "Notes": "Copay = 45+58 (SV) / 55+68 (MF)", "Copay": 123.0, "VSP": 0.0, "Chargeback": 40.0, "Code": "BA+BH"}, {"Category": "Material", "Enhancement": "Digital Aspheric \u2013 High-index Plastic 1.70 and Above", "Notes": "Copay = 45+86 (SV)", "Copay": 131.0, "VSP": 0.0, "Chargeback": 57.0, "Code": "BA+BJ"}, {"Category": "Material", "Enhancement": "Digital Aspheric \u2013 Polycarbonate", "Notes": "Copay = 45+10 (SV) / 55+10 (MF)", "Copay": 55.0, "VSP": 0.0, "Chargeback": 10.0, "Code": "BA+BD"}, {"Category": "Material", "Enhancement": "Digital Aspheric \u2013 Polycarbonate", "Notes": "Copay = 45+10 (SV) / 55+10 (MF)", "Copay": 65.0, "VSP": 0.0, "Chargeback": 10.0, "Code": "BA+BD"}, {"Category": "Sun/Polarized", "Enhancement": "Polarized Lenses \u2013 Plastic A", "Notes": "nan", "Copay": 57.0, "VSP": 0.0, "Chargeback": 36.0, "Code": "DA"}, {"Category": "Sun/Polarized", "Enhancement": "Polarized Lenses \u2013 Plastic A", "Notes": "nan", "Copay": 77.0, "VSP": 0.0, "Chargeback": 48.0, "Code": "DA"}, {"Category": "Sun/Polarized", "Enhancement": "Polarized \u2013 High-index Plastic 1.53\u20131.60/Trivex", "Notes": "Copay = 57+76 (SV) / 77+95 (MF)", "Copay": 133.0, "VSP": 0.0, "Chargeback": 47.0, "Code": "DA+DB"}, {"Category": "Sun/Polarized", "Enhancement": "Polarized \u2013 High-index Plastic 1.53\u20131.60/Trivex", "Notes": "Copay = 57+76 (SV) / 77+95 (MF)", "Copay": 172.0, "VSP": 0.0, "Chargeback": 59.0, "Code": "DA+DB"}, {"Category": "Sun/Polarized", "Enhancement": "Polarized \u2013 High-index Plastic 1.66/1.67", "Notes": "Copay = 57+89 (SV) / 77+108 (MF)", "Copay": 146.0, "VSP": 0.0, "Chargeback": 55.0, "Code": "DA+DH"}, {"Category": "Sun/Polarized", "Enhancement": "Polarized \u2013 High-index Plastic 1.66/1.67", "Notes": "Copay = 57+89 (SV) / 77+108 (MF)", "Copay": 185.0, "VSP": 0.0, "Chargeback": 67.0, "Code": "DA+DH"}, {"Category": "Sun/Polarized", "Enhancement": "Polarized \u2013 High-index Plastic 1.70 and Above", "Notes": "Copay = 57+108 (SV)", "Copay": 165.0, "VSP": 0.0, "Chargeback": 70.0, "Code": "DA+DJ"}, {"Category": "Sun/Polarized", "Enhancement": "Polarized \u2013 Polycarbonate", "Notes": "Copay = 57+31 (SV) / 77+31 (MF)", "Copay": 88.0, "VSP": 0.0, "Chargeback": 13.0, "Code": "DA+DD"}, {"Category": "Sun/Polarized", "Enhancement": "Polarized \u2013 Polycarbonate", "Notes": "Copay = 57+31 (SV) / 77+31 (MF)", "Copay": 108.0, "VSP": 0.0, "Chargeback": 13.0, "Code": "DA+DD"}, {"Category": "Sun/Polarized", "Enhancement": "Polarized/Laminated Lenses \u2013 Glass", "Notes": "nan", "Copay": 78.0, "VSP": 0.0, "Chargeback": 49.0, "Code": "DE"}, {"Category": "Sun/Polarized", "Enhancement": "Polarized/Laminated Lenses \u2013 Glass", "Notes": "nan", "Copay": 101.0, "VSP": 0.0, "Chargeback": 63.0, "Code": "DE"}, {"Category": "Bifocal/Occupational", "Enhancement": "Near Variable Focus \u2013 Plastic", "Notes": "nan", "Copay": 50.0, "VSP": 0.0, "Chargeback": 26.0, "Code": "IA"}, {"Category": "Bifocal/Occupational", "Enhancement": "Near Variable Focus \u2013 High-index Plastic 1.53\u20131.60/Trivex", "Notes": "Copay = 50+24 (MF)", "Copay": 74.0, "VSP": 0.0, "Chargeback": 11.0, "Code": "IA+IB"}, {"Category": "Bifocal/Occupational", "Enhancement": "Near Variable Focus \u2013 High-index Plastic 1.66/1.67", "Notes": "Copay = 50+50 (MF)", "Copay": 100.0, "VSP": 0.0, "Chargeback": 27.0, "Code": "IA+II"}, {"Category": "Bifocal/Occupational", "Enhancement": "Near Variable Focus \u2013 High-index Plastic 1.70 and Above", "Notes": "Copay = 50+60 (MF)", "Copay": 110.0, "VSP": 0.0, "Chargeback": 36.0, "Code": "IA+IJ"}, {"Category": "Bifocal/Occupational", "Enhancement": "Near Variable Focus \u2013 Polycarbonate", "Notes": "Copay = 50+20 (MF)", "Copay": 70.0, "VSP": 0.0, "Chargeback": 7.0, "Code": "IA+ID"}, {"Category": "Bifocal/Occupational", "Enhancement": "Blended Bifocal \u2013 Plastic", "Notes": "nan", "Copay": 30.0, "VSP": 0.0, "Chargeback": 14.0, "Code": "GA"}, {"Category": "Tint", "Enhancement": "Plastic Dyes \u2013 Solid Color (Except Pink I and II)", "Notes": "nan", "Copay": 15.0, "VSP": 0.0, "Chargeback": 5.0, "Code": "MN"}, {"Category": "Tint", "Enhancement": "Plastic Dyes \u2013 Solid Color (Except Pink I and II)", "Notes": "nan", "Copay": 15.0, "VSP": 0.0, "Chargeback": 5.0, "Code": "MN"}, {"Category": "Tint", "Enhancement": "Plastic Dyes \u2013 Gradient", "Notes": "nan", "Copay": 17.0, "VSP": 0.0, "Chargeback": 7.0, "Code": "MP"}, {"Category": "Tint", "Enhancement": "Plastic Dyes \u2013 Gradient", "Notes": "nan", "Copay": 17.0, "VSP": 0.0, "Chargeback": 7.0, "Code": "MP"}, {"Category": "Tint (Glass)", "Enhancement": "Glass Tints Solid (Except Pink I and II and Yellow)", "Notes": "nan", "Copay": 34.0, "VSP": 0.0, "Chargeback": 16.0, "Code": "MR"}, {"Category": "Tint (Glass)", "Enhancement": "Glass Tints Solid (Except Pink I and II and Yellow)", "Notes": "nan", "Copay": 44.0, "VSP": 0.0, "Chargeback": 24.0, "Code": "MR"}, {"Category": "Tint (Glass)", "Enhancement": "Glass Color Coatings \u2013 Solid", "Notes": "nan", "Copay": 42.0, "VSP": 0.0, "Chargeback": 22.0, "Code": "MS"}, {"Category": "Tint (Glass)", "Enhancement": "Glass Color Coatings \u2013 Solid", "Notes": "nan", "Copay": 42.0, "VSP": 0.0, "Chargeback": 22.0, "Code": "MS"}, {"Category": "Tint (Glass)", "Enhancement": "Glass Color Coatings \u2013 Gradient", "Notes": "nan", "Copay": 46.0, "VSP": 0.0, "Chargeback": 25.0, "Code": "MT"}, {"Category": "Tint (Glass)", "Enhancement": "Glass Color Coatings \u2013 Gradient", "Notes": "nan", "Copay": 46.0, "VSP": 0.0, "Chargeback": 25.0, "Code": "MT"}, {"Category": "Photochromic", "Enhancement": "Photochromics \u2013 Glass", "Notes": "nan", "Copay": 33.0, "VSP": 0.0, "Chargeback": 15.0, "Code": "PM"}, {"Category": "Photochromic", "Enhancement": "Photochromics \u2013 Glass", "Notes": "nan", "Copay": 41.0, "VSP": 0.0, "Chargeback": 23.0, "Code": "PM"}, {"Category": "Photochromic", "Enhancement": "Photochromics \u2013 Plastic", "Notes": "nan", "Copay": 75.0, "VSP": 0.0, "Chargeback": 45.0, "Code": "PR"}, {"Category": "Photochromic", "Enhancement": "Photochromics \u2013 Plastic", "Notes": "nan", "Copay": 75.0, "VSP": 0.0, "Chargeback": 45.0, "Code": "PR"}, {"Category": "Coating", "Enhancement": "Anti-reflective Coating A", "Notes": "nan", "Copay": 41.0, "VSP": 0.0, "Chargeback": 21.0, "Code": "QM"}, {"Category": "Coating", "Enhancement": "Anti-reflective Coating A", "Notes": "nan", "Copay": 41.0, "VSP": 0.0, "Chargeback": 21.0, "Code": "QM"}, {"Category": "Coating", "Enhancement": "Anti-reflective Coating C", "Notes": "nan", "Copay": 68.0, "VSP": 0.0, "Chargeback": 41.0, "Code": "QT"}, {"Category": "Coating", "Enhancement": "Anti-reflective Coating C", "Notes": "nan", "Copay": 68.0, "VSP": 0.0, "Chargeback": 41.0, "Code": "QT"}, {"Category": "Coating", "Enhancement": "Anti-reflective Coating D", "Notes": "nan", "Copay": 85.0, "VSP": 0.0, "Chargeback": 52.0, "Code": "QV"}, {"Category": "Coating", "Enhancement": "Anti-reflective Coating D", "Notes": "nan", "Copay": 85.0, "VSP": 0.0, "Chargeback": 52.0, "Code": "QV"}, {"Category": "Coating", "Enhancement": "Mirror \u2013 Solid and Single Gradient (Includes Base Color)", "Notes": "nan", "Copay": 49.0, "VSP": 0.0, "Chargeback": 26.0, "Code": "QP"}, {"Category": "Coating", "Enhancement": "Mirror \u2013 Solid and Single Gradient (Includes Base Color)", "Notes": "nan", "Copay": 49.0, "VSP": 0.0, "Chargeback": 26.0, "Code": "QP"}, {"Category": "Coating", "Enhancement": "Ski Type (Includes Base Tint and Backside Color)", "Notes": "nan", "Copay": 55.0, "VSP": 0.0, "Chargeback": 30.0, "Code": "QR"}, {"Category": "Coating", "Enhancement": "Ski Type (Includes Base Tint and Backside Color)", "Notes": "nan", "Copay": 55.0, "VSP": 0.0, "Chargeback": 30.0, "Code": "QR"}, {"Category": "Coating", "Enhancement": "Scratch-resistant Coating A \u2013 Factory Applied", "Notes": "nan", "Copay": 17.0, "VSP": 0.0, "Chargeback": 7.0, "Code": "QQ"}, {"Category": "Coating", "Enhancement": "Scratch-resistant Coating A \u2013 Factory Applied", "Notes": "nan", "Copay": 17.0, "VSP": 0.0, "Chargeback": 7.0, "Code": "QQ"}, {"Category": "Coating", "Enhancement": "Scratch-resistant Coating B \u2013 Other Approved Coatings", "Notes": "nan", "Copay": 33.0, "VSP": 0.0, "Chargeback": 15.0, "Code": "QS"}, {"Category": "Coating", "Enhancement": "Scratch-resistant Coating B \u2013 Other Approved Coatings", "Notes": "nan", "Copay": 33.0, "VSP": 0.0, "Chargeback": 15.0, "Code": "QS"}, {"Category": "Oversize", "Enhancement": "Frames Stamped 61mm Eye Size or Greater \u2013 Plastic", "Notes": "nan", "Copay": 11.0, "VSP": 0.0, "Chargeback": 5.0, "Code": "RM"}, {"Category": "Oversize", "Enhancement": "Frames Stamped 61mm Eye Size or Greater \u2013 Plastic", "Notes": "nan", "Copay": 14.0, "VSP": 0.0, "Chargeback": 6.0, "Code": "RM"}, {"Category": "Oversize", "Enhancement": "Frames Stamped 61mm Eye Size or Greater \u2013 Glass", "Notes": "nan", "Copay": 13.0, "VSP": 0.0, "Chargeback": 7.0, "Code": "RN"}, {"Category": "Oversize", "Enhancement": "Frames Stamped 61mm Eye Size or Greater \u2013 Glass", "Notes": "nan", "Copay": 18.0, "VSP": 0.0, "Chargeback": 10.0, "Code": "RN"}, {"Category": "Misc", "Enhancement": "High Luster Edge Polish", "Notes": "nan", "Copay": 16.0, "VSP": 0.0, "Chargeback": 6.0, "Code": "SP"}, {"Category": "Misc", "Enhancement": "High Luster Edge Polish", "Notes": "nan", "Copay": 16.0, "VSP": 0.0, "Chargeback": 6.0, "Code": "SP"}, {"Category": "Misc", "Enhancement": "Edge Coating", "Notes": "nan", "Copay": 36.0, "VSP": 0.0, "Chargeback": 17.0, "Code": "SQ"}, {"Category": "Misc", "Enhancement": "Edge Coating", "Notes": "nan", "Copay": 36.0, "VSP": 0.0, "Chargeback": 17.0, "Code": "SQ"}, {"Category": "Misc", "Enhancement": "Faceted Lenses (Includes Polishing)", "Notes": "nan", "Copay": 66.0, "VSP": 0.0, "Chargeback": 41.0, "Code": "SR"}, {"Category": "Misc", "Enhancement": "Faceted Lenses (Includes Polishing)", "Notes": "nan", "Copay": 66.0, "VSP": 0.0, "Chargeback": 41.0, "Code": "SR"}, {"Category": "Misc", "Enhancement": "Rimless Drill", "Notes": "nan", "Copay": 30.0, "VSP": 0.0, "Chargeback": 25.0, "Code": "SW"}, {"Category": "Misc", "Enhancement": "Rimless Drill", "Notes": "nan", "Copay": 30.0, "VSP": 0.0, "Chargeback": 25.0, "Code": "SW"}, {"Category": "Misc", "Enhancement": "UV Protection", "Notes": "nan", "Copay": 16.0, "VSP": 0.0, "Chargeback": 6.0, "Code": "SV"}, {"Category": "Misc", "Enhancement": "UV Protection", "Notes": "nan", "Copay": 16.0, "VSP": 0.0, "Chargeback": 6.0, "Code": "SV"}, {"Category": "Misc", "Enhancement": "UV Protection \u2013 Backside", "Notes": "nan", "Copay": 10.0, "VSP": 0.0, "Chargeback": 7.0, "Code": "BV"}, {"Category": "Misc", "Enhancement": "UV Protection \u2013 Backside", "Notes": "nan", "Copay": 10.0, "VSP": 0.0, "Chargeback": 7.0, "Code": "BV"}, {"Category": "Misc", "Enhancement": "Light Filter", "Notes": "nan", "Copay": 15.0, "VSP": 0.0, "Chargeback": 11.0, "Code": "LF"}, {"Category": "Misc", "Enhancement": "Light Filter", "Notes": "nan", "Copay": 15.0, "VSP": 0.0, "Chargeback": 11.0, "Code": "LF"}, {"Category": "Misc", "Enhancement": "Technical Add-On", "Notes": "nan", "Copay": 10.0, "VSP": 0.0, "Chargeback": 8.0, "Code": "TA"}, {"Category": "Doctor Supplied", "Enhancement": "Plastic Dyes \u2013 Solid Color (Pink I and II)", "Notes": "nan", "Copay": 0.0, "VSP": 0.0, "Chargeback": 5.0, "Code": "IM"}, {"Category": "Doctor Supplied", "Enhancement": "Plastic Dyes \u2013 Solid Color (Pink I and II)", "Notes": "nan", "Copay": 0.0, "VSP": 0.0, "Chargeback": 5.0, "Code": "IM"}, {"Category": "Doctor Supplied", "Enhancement": "Plastic Dyes \u2013 Solid Color (Except Pink I and II)", "Notes": "nan", "Copay": 15.0, "VSP": 0.0, "Chargeback": 5.0, "Code": "IN"}, {"Category": "Doctor Supplied", "Enhancement": "Plastic Dyes \u2013 Solid Color (Except Pink I and II)", "Notes": "nan", "Copay": 15.0, "VSP": 0.0, "Chargeback": 5.0, "Code": "IN"}, {"Category": "Doctor Supplied", "Enhancement": "Plastic Dyes \u2013 Gradient", "Notes": "nan", "Copay": 17.0, "VSP": 0.0, "Chargeback": 7.0, "Code": "IP"}, {"Category": "Doctor Supplied", "Enhancement": "Plastic Dyes \u2013 Gradient", "Notes": "nan", "Copay": 17.0, "VSP": 0.0, "Chargeback": 7.0, "Code": "IP"}, {"Category": "Doctor Supplied", "Enhancement": "UV Protection", "Notes": "nan", "Copay": 16.0, "VSP": 0.0, "Chargeback": 6.0, "Code": "IV"}, {"Category": "Doctor Supplied", "Enhancement": "UV Protection", "Notes": "nan", "Copay": 16.0, "VSP": 0.0, "Chargeback": 6.0, "Code": "IV"}, {"Category": "Progressive", "Enhancement": "Custom Measurements (on Eligible Progressive N or O) Lenses", "Notes": "nan", "Copay": 10.0, "VSP": 0.0, "Chargeback": 2.0, "Code": "CM"}, {"Category": "Progressive", "Enhancement": "Progressive N \u2013 Plastic", "Notes": "nan", "Copay": 175.0, "VSP": 0.0, "Chargeback": 95.0, "Code": "nan"}, {"Category": "Progressive", "Enhancement": "Progressive N \u2013 High-index Plastic 1.53\u20131.60/Trivex", "Notes": "Copay = 175+47", "Copay": 222.0, "VSP": 0.0, "Chargeback": 25.0, "Code": "NA+NB"}, {"Category": "Progressive", "Enhancement": "Progressive N \u2013 High-index Plastic 1.66/1.67", "Notes": "Copay = 175+78", "Copay": 253.0, "VSP": 0.0, "Chargeback": 48.0, "Code": "NA+NH"}, {"Category": "Progressive", "Enhancement": "Progressive N \u2013 High-index Plastic 1.70 and Above", "Notes": "Copay = 175+125", "Copay": 300.0, "VSP": 0.0, "Chargeback": 77.0, "Code": "NA+NJ"}, {"Category": "Progressive", "Enhancement": "Progressive N \u2013 Polycarbonate", "Notes": "Copay = 175+35", "Copay": 210.0, "VSP": 0.0, "Chargeback": 15.0, "Code": "NA+ND"}, {"Category": "Progressive", "Enhancement": "Progressive N \u2013 Polarized", "Notes": "Copay = 175+82", "Copay": 257.0, "VSP": 0.0, "Chargeback": 51.0, "Code": "NA+NP"}, {"Category": "Progressive", "Enhancement": "Progressive O \u2013 Plastic", "Notes": "nan", "Copay": 150.0, "VSP": 0.0, "Chargeback": 79.0, "Code": "OA"}, {"Category": "Progressive", "Enhancement": "Progressive O \u2013 High-index Plastic 1.53\u20131.60/Trivex", "Notes": "Copay = 150+47", "Copay": 197.0, "VSP": 0.0, "Chargeback": 25.0, "Code": "OA+OB"}, {"Category": "Progressive", "Enhancement": "Progressive O \u2013 High-index Plastic 1.66/1.67", "Notes": "Copay = 150+78", "Copay": 228.0, "VSP": 0.0, "Chargeback": 48.0, "Code": "OA+OH"}, {"Category": "Progressive", "Enhancement": "Progressive O \u2013 High-index Plastic 1.70 and Above", "Notes": "Copay = 150+125", "Copay": 275.0, "VSP": 0.0, "Chargeback": 77.0, "Code": "OA+OJ"}, {"Category": "Progressive", "Enhancement": "Progressive O \u2013 Polycarbonate", "Notes": "Copay = 150+35", "Copay": 185.0, "VSP": 0.0, "Chargeback": 15.0, "Code": "OA+OD"}, {"Category": "Progressive", "Enhancement": "Progressive O \u2013 Polarized", "Notes": "Copay = 150+82", "Copay": 232.0, "VSP": 0.0, "Chargeback": 51.0, "Code": "OA+OP"}, {"Category": "Progressive", "Enhancement": "Progressive F \u2013 Plastic", "Notes": "nan", "Copay": 105.0, "VSP": 0.0, "Chargeback": 54.0, "Code": "FA"}, {"Category": "Progressive", "Enhancement": "Progressive F \u2013 High-index Plastic 1.53\u20131.60/Trivex", "Notes": "Copay = 105+47", "Copay": 152.0, "VSP": 0.0, "Chargeback": 25.0, "Code": "FA+FB"}, {"Category": "Progressive", "Enhancement": "Progressive F \u2013 High-index Plastic 1.66/1.67", "Notes": "Copay = 105+78", "Copay": 183.0, "VSP": 0.0, "Chargeback": 48.0, "Code": "FA+FH"}, {"Category": "Progressive", "Enhancement": "Progressive F \u2013 High-index Plastic 1.70 and Above", "Notes": "Copay = 105+125", "Copay": 230.0, "VSP": 0.0, "Chargeback": 77.0, "Code": "FA+FJ"}, {"Category": "Progressive", "Enhancement": "Progressive F \u2013 Polycarbonate", "Notes": "Copay = 105+35", "Copay": 140.0, "VSP": 0.0, "Chargeback": 15.0, "Code": "FA+FD"}, {"Category": "Progressive", "Enhancement": "Progressive F \u2013 Polarized", "Notes": "Copay = 105+82", "Copay": 187.0, "VSP": 0.0, "Chargeback": 51.0, "Code": "FA+FP"}, {"Category": "Progressive", "Enhancement": "Progressive F \u2013 Glass/High-index Glass (Clear)", "Notes": "nan", "Copay": 110.0, "VSP": 0.0, "Chargeback": 59.0, "Code": "FE"}, {"Category": "Progressive", "Enhancement": "Progressive J \u2013 Plastic", "Notes": "nan", "Copay": 95.0, "VSP": 0.0, "Chargeback": 46.0, "Code": "JA"}, {"Category": "Progressive", "Enhancement": "Progressive J \u2013 High-index Plastic 1.53\u20131.60/Trivex", "Notes": "Copay = 95+47", "Copay": 142.0, "VSP": 0.0, "Chargeback": 25.0, "Code": "JA+JB"}, {"Category": "Progressive", "Enhancement": "Progressive J \u2013 High-index Plastic 1.66/1.67", "Notes": "Copay = 95+78", "Copay": 173.0, "VSP": 0.0, "Chargeback": 48.0, "Code": "JA+JH"}, {"Category": "Progressive", "Enhancement": "Progressive J \u2013 High-index Plastic 1.70 and Above", "Notes": "Copay = 95+125", "Copay": 220.0, "VSP": 0.0, "Chargeback": 77.0, "Code": "JA+JJ"}, {"Category": "Progressive", "Enhancement": "Progressive J \u2013 Polycarbonate", "Notes": "Copay = 95+35", "Copay": 130.0, "VSP": 0.0, "Chargeback": 15.0, "Code": "JA+JD"}, {"Category": "Progressive", "Enhancement": "Progressive J \u2013 Polarized", "Notes": "Copay = 95+82", "Copay": 177.0, "VSP": 0.0, "Chargeback": 51.0, "Code": "JA+JP"}, {"Category": "Progressive", "Enhancement": "Progressive J \u2013 Glass/High-index Glass (Clear)", "Notes": "nan", "Copay": 105.0, "VSP": 0.0, "Chargeback": 56.0, "Code": "JE"}, {"Category": "Progressive", "Enhancement": "Progressive K \u2013 Plastic", "Notes": "nan", "Copay": 55.0, "VSP": 0.0, "Chargeback": 28.0, "Code": "KA"}, {"Category": "Progressive", "Enhancement": "Progressive K \u2013 High-index Plastic 1.53\u20131.60/Trivex", "Notes": "Copay = 55+47", "Copay": 102.0, "VSP": 0.0, "Chargeback": 25.0, "Code": "KA+KB"}, {"Category": "Progressive", "Enhancement": "Progressive K \u2013 High-index Plastic 1.66/1.67", "Notes": "Copay = 55+78", "Copay": 133.0, "VSP": 0.0, "Chargeback": 48.0, "Code": "KA+KH"}, {"Category": "Progressive", "Enhancement": "Progressive K \u2013 High-index Plastic 1.70 and Above", "Notes": "Copay = 55+125", "Copay": 180.0, "VSP": 0.0, "Chargeback": 77.0, "Code": "KA+KJ"}, {"Category": "Progressive", "Enhancement": "Progressive K \u2013 Polycarbonate", "Notes": "Copay = 55+35", "Copay": 90.0, "VSP": 0.0, "Chargeback": 15.0, "Code": "KA+KD"}, {"Category": "Progressive", "Enhancement": "Progressive K \u2013 Polarized", "Notes": "Copay = 55+82", "Copay": 137.0, "VSP": 0.0, "Chargeback": 51.0, "Code": "KA+KP"}, {"Category": "Progressive", "Enhancement": "Progressive K \u2013 Glass/High-index Glass (Clear)", "Notes": "nan", "Copay": 80.0, "VSP": 0.0, "Chargeback": 53.0, "Code": "KE"}];const $=q=>document.querySelector(q);const num=n=>Number(n||0).toLocaleString('en-US',{style:'currency',currency:'USD'});const clean=s=>(s==null?'':String(s).replace(/^nan$/i,'').trim());function renderMaster(){const tb=$('#master');tb.innerHTML='';MASTER.forEach(r=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${clean(r.Category)}</td><td>${clean(r.Enhancement)}</td><td>${clean(r.Code)}</td><td>${clean(r.Notes)}</td><td style=text-align:right>${num(r.Copay)}</td><td style=text-align:right>${num(r.VSP)}</td><td style=text-align:right>${num(r.Chargeback)}</td>`;tb.appendChild(tr);});}renderMaster();const byEnh=rx=>MASTER.filter(r=>new RegExp(rx,'i').test(r.Enhancement||''));const byCat=rx=>MASTER.filter(r=>new RegExp(rx,'i').test(r.Category||''));const maxBy=(a,k)=>a.reduce((x,y)=>Number(y[k]||0)>Number(x[k]||0)?y:x,a[0]||null);const minBy=(a,k)=>a.reduce((x,y)=>Number(y[k]||0)<Number(x[k]||0)?y:x,a[0]||null);function pickMaterial(level){let hi=byEnh('high[- ]?index\s*(1\.7[014]|1\.67)');if(level==='BEST'&&hi.length)return maxBy(hi,'Copay');let mid=byEnh('high[- ]?index\s*1\.6[0-9]?');if(level!=='BASIC'&&mid.length)return maxBy(mid,'Copay');let poly=byEnh('polycarb');if(poly.length)return maxBy(poly,'Copay');let cr=byEnh('CR-?39|aspheric\s*plastic\s*1\.50|plastic\s*1\.50');if(cr.length)return minBy(cr,'Copay');let m=byCat('material');return m[0]||null;}function pickProgressive(level){const p=MASTER.filter(r=>/progressive/i.test(r.Category||'')||/progressive/i.test(r.Enhancement||''));if(!p.length)return null;if(level==='BEST')return maxBy(p,'Copay');if(level==='BASIC')return minBy(p,'Copay');const s=p.slice().sort((a,b)=>a.Copay-b.Copay);return s[Math.floor(s.length/2)];}function pickAR(level){let a=MASTER.filter(r=>/anti[- ]?reflect|coating\s*[A-E]\b|\bAR\b/i.test(r.Enhancement||'')||/Coating/i.test(r.Category||''));if(!a.length)return null;const rank=e=>{e=(e||'').toUpperCase();if(/\bE\b/.test(e))return 5;if(/\bD\b/.test(e))return 4;if(/\bC\b/.test(e))return 3;if(/\bB\b/.test(e))return 2;if(/\bA\b/.test(e))return 1;return 0;};a.sort((x,y)=>rank(y.Enhancement)-rank(x.Enhancement)||(y.Copay-x.Copay));if(level==='BEST')return a[0];if(level==='BASIC')return a[a.length-1];return a[Math.max(0,Math.floor(a.length/2)-1)];}function pickSun(path){if(path==='Photochromic'){const p=byEnh('photochrom|transitions');const ng=p.filter(r=>!/glass/i.test(r.Enhancement||''));return ng[0]||p[0]||null;}if(path==='Polarized'){return byEnh('polar')[0]||null;}if(path==='Tint'){return byEnh('tint')[0]||null;}return null;}function dedupe(items){const s=new Set();return items.filter(i=>{if(!i)return false;const k=(i.Category||'')+'|'+(i.Enhancement||'');if(s.has(k))return false;s.add(k);return true;});}function totals(items){const c=items.reduce((s,r)=>s+Number(r.Copay||0),0);const v=items.reduce((s,r)=>s+Number(r.VSP||0),0);const cb=items.reduce((s,r)=>s+Number(r.Chargeback||0),0);return {copay:c,vsp:v,cb:cb,revenue:c+v-cb};}function buildTier(track,sun,level){let items=[];items.push(pickMaterial(level));if(track==='Progressive')items.push(pickProgressive(level));items.push(pickAR(level));const sitem=pickSun(sun);if(sitem)items.push(sitem);return dedupe(items);}document.getElementById('build').addEventListener('click',()=>{const t=$('#track').value;const s=$('#sun').value;const over=$('#over').value;const rim=$('#rim').value;const tiers=[{name:'BEST',items:buildTier(t,s,'BEST')},{name:'MID',items:buildTier(t,s,'MID')},{name:'BASIC',items:buildTier(t,s,'BASIC')}];if(over!=='None'){const os=MASTER.find(r=>/oversize/i.test(r.Enhancement||''));if(os)tiers.forEach(tt=>tt.items.push(os));}if(rim==='Drill'){const rl=MASTER.find(r=>/rimless|drill/i.test(r.Enhancement||''));if(rl)tiers.forEach(tt=>tt.items.push(rl));}$('#tiers').style.display='block';const tb=$('#tierbody');tb.innerHTML='';const k=$('#kpis');k.innerHTML='';tiers.forEach(tt=>{const x=totals(tt.items);const list=tt.items.map(i=>clean(i.Enhancement)).join(', ');const tr=document.createElement('tr');tr.innerHTML=`<td><b>${tt.name}</b></td><td>${list}</td><td style=text-align:right>${num(x.copay)}</td><td style=text-align:right>${num(x.vsp)}</td><td style=text-align:right>${num(x.cb)}</td><td style=text-align:right><b>${num(x.revenue)}</b></td>`;tb.appendChild(tr);const div=document.createElement('span');div.className='kpi';div.innerHTML=`<small>${tt.name} revenue</small> <b>${num(x.revenue)}</b>`;k.appendChild(div);});});document.getElementById('csv').addEventListener('click',()=>{const t=$('#track').value;const s=$('#sun').value;const tiers=[{name:'BEST',items:buildTier(t,s,'BEST')},{name:'MID',items:buildTier(t,s,'MID')},{name:'BASIC',items:buildTier(t,s,'BASIC')}];const rows=[["Tier","Category","Enhancement","Code","Copay","VSP","Chargeback"]];tiers.forEach(tt=>tt.items.forEach(i=>rows.push([tt.name,clean(i.Category),clean(i.Enhancement),clean(i.Code),i.Copay||0,i.VSP||0,i.Chargeback||0])));const csv=rows.map(r=>r.map(x=>`"${(x??'').toString().replace(/"/g,'""')}"`).join(',')).join('\n');const a=document.createElement('a');a.href=URL.createObjectURL(new Blob([csv],{type:'text/csv'}));a.download='revopt_quote.csv';a.click();});</script>